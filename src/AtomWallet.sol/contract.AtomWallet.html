<!DOCTYPE HTML>
<html lang="en" class="dark sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AtomWallet - Intuition Beta Contracts Documentation</title>


        <!-- Custom HTML head -->
        <!-- Include Mermaid -->
        <script src='https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js'></script>
        
        <!-- Include MathJax -->
        <script>
          window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true, processEnvironments: true }, options: { skipHtmlTags: ['script', 'noscript', 'style',
          'textarea', 'pre'] } };
        </script>
        <script
          type='text/javascript'
          id='MathJax-script'
          async
          src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
        >
        </script>
        
        <script>
          window.addEventListener('load', function() { mermaid.initialize({ startOnLoad: true, theme: 'dark', securityLevel:
          'loose', themeVariables: { darkMode: true }, flowchart: { htmlLabels: true, curve: 'basis', useMaxWidth: true }, zoom:
          { enabled: true, maxZoom: 10, minZoom: 0.1 }, menu: { enabled: true, showMenu: true, menuItems: [ { name: 'Zoom In',
          action: function() { mermaid.mermaidAPI.zoomIn(); } }, { name: 'Zoom Out', action: function() {
          mermaid.mermaidAPI.zoomOut(); } }, { name: 'Reset Zoom', action: function() { mermaid.mermaidAPI.reset(); } } ] } });
          });
        </script>
        
        <style>
          .mermaid { width: 100% !important; } /* Style the menu */ .mermaid-menu { background-color: #2d2d2d !important;
          border: 1px solid #444 !important; padding: 5px !important; border-radius: 4px !important; } .mermaid-menu-item {
          color: #fff !important; padding: 5px 10px !important; cursor: pointer !important; } .mermaid-menu-item:hover {
          background-color: #444 !important; }
        </style>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../book.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "dark";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Intuition Beta Contracts Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/0xIntuition/intuition-beta-contracts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="atomwallet"><a class="header" href="#atomwallet">AtomWallet</a></h1>
<p><a href="https://github.com/0xIntuition/intuition-beta-contracts/blob/be7abe84df5527833e1ade9bdf33ba67cc9ea194/src/AtomWallet.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Initializable, BaseAccount, Ownable2StepUpgradeable, ReentrancyGuardUpgradeable</p>
<p><strong>Author:</strong>
0xIntuition</p>
<p>Core contract of the Intuition protocol. This contract is an abstract account
associated with a corresponding atom.</p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="ethmultivault"><a class="header" href="#ethmultivault">ethMultiVault</a></h3>
<p>The EthMultiVault contract address</p>
<pre><code class="language-solidity">IEthMultiVault public ethMultiVault;
</code></pre>
<h3 id="isclaimed"><a class="header" href="#isclaimed">isClaimed</a></h3>
<p>The flag to indicate if the wallet's ownership has been claimed by the user</p>
<pre><code class="language-solidity">bool public isClaimed;
</code></pre>
<h3 id="atomwalletownerstoragelocation"><a class="header" href="#atomwalletownerstoragelocation">AtomWalletOwnerStorageLocation</a></h3>
<p>The storage slot for the AtomWallet owner</p>
<pre><code class="language-solidity">bytes32 private constant AtomWalletOwnerStorageLocation =
    0x9016d09d72d40fdae2fd8ceac6b6234c7706214fd39c1cd1e609a0528c199300;
</code></pre>
<h3 id="atomwalletpendingownerstoragelocation"><a class="header" href="#atomwalletpendingownerstoragelocation">AtomWalletPendingOwnerStorageLocation</a></h3>
<p>The storage slot for the AtomWallet pending owner</p>
<pre><code class="language-solidity">bytes32 private constant AtomWalletPendingOwnerStorageLocation =
    0x237e158222e3e6968b72b9db0d8043aacf074ad9f650f0d1606b4d82ee432c00;
</code></pre>
<h3 id="_entrypoint"><a class="header" href="#_entrypoint">_entryPoint</a></h3>
<p>The entry point contract address</p>
<pre><code class="language-solidity">IEntryPoint private _entryPoint;
</code></pre>
<h3 id="__gap"><a class="header" href="#__gap">__gap</a></h3>
<p><em>Gap for upgrade safety</em></p>
<pre><code class="language-solidity">uint256[50] private __gap;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="onlyownerorentrypoint"><a class="header" href="#onlyownerorentrypoint">onlyOwnerOrEntryPoint</a></h3>
<p><em>Modifier to allow only the owner or entry point to call a function</em></p>
<pre><code class="language-solidity">modifier onlyOwnerOrEntryPoint();
</code></pre>
<h3 id="init"><a class="header" href="#init">init</a></h3>
<p>Initialize the AtomWallet contract</p>
<pre><code class="language-solidity">function init(IEntryPoint anEntryPoint, IEthMultiVault _ethMultiVault) external initializer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>anEntryPoint</code></td><td><code>IEntryPoint</code></td><td>the entry point contract address</td></tr>
<tr><td><code>_ethMultiVault</code></td><td><code>IEthMultiVault</code></td><td>the EthMultiVault contract address</td></tr>
</tbody></table>
</div>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="execute"><a class="header" href="#execute">execute</a></h3>
<pre><code class="language-solidity">function execute(address dest, uint256 value, bytes calldata func)
    external
    payable
    onlyOwnerOrEntryPoint
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>dest</code></td><td><code>address</code></td><td>the target address</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>the value to send</td></tr>
<tr><td><code>func</code></td><td><code>bytes</code></td><td>the function call data</td></tr>
</tbody></table>
</div>
<h3 id="executebatch"><a class="header" href="#executebatch">executeBatch</a></h3>
<p>Execute a sequence (batch) of transactions</p>
<pre><code class="language-solidity">function executeBatch(address[] calldata dest, uint256[] calldata values, bytes[] calldata func)
    external
    payable
    onlyOwnerOrEntryPoint
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>dest</code></td><td><code>address[]</code></td><td>the target addresses array</td></tr>
<tr><td><code>values</code></td><td><code>uint256[]</code></td><td></td></tr>
<tr><td><code>func</code></td><td><code>bytes[]</code></td><td>the function call data array</td></tr>
</tbody></table>
</div>
<h3 id="adddeposit"><a class="header" href="#adddeposit">addDeposit</a></h3>
<p>Add deposit to the account in the entry point contract</p>
<pre><code class="language-solidity">function addDeposit() public payable;
</code></pre>
<h3 id="withdrawdepositto"><a class="header" href="#withdrawdepositto">withdrawDepositTo</a></h3>
<p>Withdraws value from the account's deposit</p>
<pre><code class="language-solidity">function withdrawDepositTo(address payable withdrawAddress, uint256 amount) public;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>withdrawAddress</code></td><td><code>address payable</code></td><td>target to send to</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>to withdraw</td></tr>
</tbody></table>
</div>
<h3 id="transferownership"><a class="header" href="#transferownership">transferOwnership</a></h3>
<p>Initiates the ownership transfer over the wallet to a new owner.</p>
<pre><code class="language-solidity">function transferOwnership(address newOwner) public override onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newOwner</code></td><td><code>address</code></td><td>the new owner of the wallet (becomes the pending owner) NOTE: Overrides the transferOwnership function of Ownable2StepUpgradeable</td></tr>
</tbody></table>
</div>
<h3 id="acceptownership"><a class="header" href="#acceptownership">acceptOwnership</a></h3>
<p>The new owner accepts the ownership over the wallet. If the wallet's ownership
is being accepted by the user, the wallet is considered claimed. Once claimed,
wallet is considered owned by the user and this action cannot be undone.
NOTE: Overrides the acceptOwnership function of Ownable2StepUpgradeable</p>
<pre><code class="language-solidity">function acceptOwnership() public override;
</code></pre>
<h3 id="getdeposit"><a class="header" href="#getdeposit">getDeposit</a></h3>
<p>Returns the deposit of the account in the entry point contract</p>
<pre><code class="language-solidity">function getDeposit() public view returns (uint256);
</code></pre>
<h3 id="entrypoint"><a class="header" href="#entrypoint">entryPoint</a></h3>
<p>Get the entry point contract address</p>
<pre><code class="language-solidity">function entryPoint() public view virtual override returns (IEntryPoint);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IEntryPoint</code></td><td>the entry point contract address NOTE: Overrides the entryPoint function of BaseAccount</td></tr>
</tbody></table>
</div>
<h3 id="owner"><a class="header" href="#owner">owner</a></h3>
<p>Returns the owner of the wallet. If the wallet has been claimed, the owner
is the user. Otherwise, the owner is the atomWarden.</p>
<pre><code class="language-solidity">function owner() public view override returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>the owner of the wallet NOTE: Overrides the owner function of OwnableUpgradeable</td></tr>
</tbody></table>
</div>
<h3 id="_validatesignature"><a class="header" href="#_validatesignature">_validateSignature</a></h3>
<p>Validate the signature of the user operation</p>
<pre><code class="language-solidity">function _validateSignature(UserOperation calldata userOp, bytes32 userOpHash)
    internal
    virtual
    override
    returns (uint256 validationData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>userOp</code></td><td><code>UserOperation</code></td><td>the user operation</td></tr>
<tr><td><code>userOpHash</code></td><td><code>bytes32</code></td><td>the hash of the user operation</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validationData</code></td><td><code>uint256</code></td><td>the validation data (0 if successful) NOTE: Implements the template method of BaseAccount</td></tr>
</tbody></table>
</div>
<h3 id="_call"><a class="header" href="#_call">_call</a></h3>
<p>An internal method that calls a target address with value and data</p>
<pre><code class="language-solidity">function _call(address target, uint256 value, bytes memory data) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>target</code></td><td><code>address</code></td><td>the target address</td></tr>
<tr><td><code>value</code></td><td><code>uint256</code></td><td>the value to send</td></tr>
<tr><td><code>data</code></td><td><code>bytes</code></td><td>the function call data</td></tr>
</tbody></table>
</div>
<h3 id="extractvaliduntilandvalidafter"><a class="header" href="#extractvaliduntilandvalidafter">extractValidUntilAndValidAfter</a></h3>
<p>Extract the validUntil and validAfter from the call data</p>
<pre><code class="language-solidity">function extractValidUntilAndValidAfter(bytes calldata callData)
    internal
    pure
    returns (uint256 validUntil, uint256 validAfter, bytes memory actualCallData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>callData</code></td><td><code>bytes</code></td><td>the call data</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>validUntil</code></td><td><code>uint256</code></td><td>the valid until timestamp</td></tr>
<tr><td><code>validAfter</code></td><td><code>uint256</code></td><td>the valid after timestamp</td></tr>
<tr><td><code>actualCallData</code></td><td><code>bytes</code></td><td>the actual call data of the user operation</td></tr>
</tbody></table>
</div>
<h3 id="_getatomwalletownerstorage"><a class="header" href="#_getatomwalletownerstorage">_getAtomWalletOwnerStorage</a></h3>
<p><em>Get the storage slot for the AtomWallet contract owner</em></p>
<pre><code class="language-solidity">function _getAtomWalletOwnerStorage() private pure returns (OwnableStorage storage $);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>$</code></td><td><code>OwnableStorage</code></td><td>the storage slot</td></tr>
</tbody></table>
</div>
<h3 id="_getatomwalletpendingownerstorage"><a class="header" href="#_getatomwalletpendingownerstorage">_getAtomWalletPendingOwnerStorage</a></h3>
<p><em>Get the storage slot for the AtomWallet contract pending owner</em></p>
<pre><code class="language-solidity">function _getAtomWalletPendingOwnerStorage() private pure returns (Ownable2StepStorage storage $);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>$</code></td><td><code>Ownable2StepStorage</code></td><td>the storage slot</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../src/libraries/Errors.sol/library.Errors.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../src/BaseCurve.sol/abstract.BaseCurve.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../src/libraries/Errors.sol/library.Errors.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../src/BaseCurve.sol/abstract.BaseCurve.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../mermaid.min.js"></script>
        <script src="../../mermaid-init.js"></script>


    </div>
    </body>
</html>
